<div class="row mb-4 no-print">
    <div class="col-12">
        <div class="card shadow-sm border-0">
            <div class="card-body p-3 d-flex justify-content-between align-items-center flex-wrap">
                <div class="fw-bold text-primary mb-2 mb-md-0">
                    <i class="bi bi-funnel-fill me-1"></i> Filter Report:
                    {% if start_date %}
                    <span class="badge bg-info text-dark">{{ start_date|date:"M d, Y" }} - {{ end_date|date:"M d, Y"
                        }}</span>
                    {% else %}
                    <span class="badge bg-secondary">All Time</span>
                    {% endif %}
                </div>
                <div class="btn-group" role="group" aria-label="Date Filters">
                    <button type="button" class="btn btn-outline-primary btn-sm"
                        onclick="applyDateFilter('today')">Today</button>
                    <button type="button" class="btn btn-outline-primary btn-sm" onclick="applyDateFilter('week')">This
                        Week</button>
                    <button type="button" class="btn btn-outline-primary btn-sm" onclick="applyDateFilter('month')">This
                        Month</button>
                    <button type="button" class="btn btn-outline-primary btn-sm" onclick="applyDateFilter('year')">This
                        Year</button>
                    <button type="button" class="btn btn-outline-secondary btn-sm" onclick="applyDateFilter('all')">All
                        Time</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function applyDateFilter(filterType) {
        const today = new Date();
        let startDate, endDate;

        endDate = today.toISOString().split('T')[0]; // Always today as end? Or end of period? Using today is safer for "up to now"

        if (filterType === 'today') {
            startDate = endDate;
        } else if (filterType === 'week') {
            const day = today.getDay(); // 0 (Sun) - 6 (Sat)
            const diff = today.getDate() - day + (day === 0 ? -6 : 1); // adjust when day is sunday
            const monday = new Date(today.setDate(diff));
            startDate = monday.toISOString().split('T')[0];
        } else if (filterType === 'month') {
            const firstDay = new Date(today.getFullYear(), today.getMonth(), 1);
            startDate = firstDay.toISOString().split('T')[0];
        } else if (filterType === 'year') {
            const firstDay = new Date(today.getFullYear(), 0, 1);
            startDate = firstDay.toISOString().split('T')[0];
        } else {
            // All time = clear params
            window.location.search = '';
            return;
        }

        // Reload with params
        const url = new URL(window.location);
        url.searchParams.set('start_date', startDate);
        url.searchParams.set('end_date', endDate);
        url.searchParams.set('filter', filterType); // Store active filter name for UI highlight if needed
        window.location.href = url.toString();
    }

    // Simple active state highlighting logic could go here
    document.addEventListener("DOMContentLoaded", function () {
        const params = new URLSearchParams(window.location.search);
        const currentFilter = params.get('filter');
        if (currentFilter) {
            // Find button and add active class?
        }
    });
</script>